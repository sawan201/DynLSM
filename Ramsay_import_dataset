import pandas as pd
import numpy as np          # or torch / tf once the array is built

# 1.  Read the file
df = pd.read_csv("international_migration_flow.csv")

# 2.  Build consistent, ordered look-up lists
months    = sorted(df["migration_month"].dropna().unique())
countries = sorted(df["country_from"].dropna().unique())   # same set for _to_

month2idx    = {m: i for i, m in enumerate(months)}
country2idx  = {c: i for i, c in enumerate(countries)}

# 3.  Allocate the tensor (48 × 180 × 180 here)
data = np.zeros((len(months), len(countries), len(countries)),
                dtype=np.int32)

# 4.  Stream the rows into the tensor
for m_from, m_to, m_month, n in df.itertuples(index=False):
    mi = month2idx[m_month]
    fi = country2idx[m_from]
    ti = country2idx[m_to]
    data[mi, fi, ti] = n          # store the count


fi, ti = country2idx["AD"], country2idx["AE"]   # both are 0 and 1
print(data[0, fi, ti])                          # → 12  (2019-01 value)

